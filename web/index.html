<!DOCTYPE html>
<html>
<head>
  <base href="$FLUTTER_BASE_HREF">
  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="RIVAYO TECH — solutions numériques.">

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="RIVAYO_TECH">
  <link rel="apple-touch-icon" href="icons/Icon-192(2).png">

  <link rel="icon" type="image/png" href="favicon-32x32.png"/>
  <title>RIVAYO_TECH</title>
  <link rel="manifest" href="manifest.json">

 <script src="https://platform.ironsrc.com/sdk/js/v1/ironsource.js"></script>

<script>
  // Nou itilize "ironSource" (ti 'i') paske se sa SDK a itilize sou Web
  const myAppKey = '4350361'; 

  function initLevelPlay() {
    if (window.ironSource) {
      window.ironSource.init({
        appKey: myAppKey,
        onSuccess: () => console.log('LevelPlay inisyalize ak siksè!'),
        onFail: (err) => console.error('Erè Inisyalizasyon:', err)
      });
    } else {
      console.error('SDK a poko chaje. Verifye koneksyon ou oswa AdBlocker.');
    }
  }

  // Tcheke chak dezyèm si SDK a parèt
  let checkSDK = setInterval(() => {
    if (window.ironSource) {
      initLevelPlay();
      clearInterval(checkSDK);
    }
  }, 1000);

  async function afichePubUnity(flutterUserId) {
    return new Promise((resolve) => {
      if (!window.ironSource) {
        console.error("SDK IronSource manke!");
        resolve(false);
        return;
      }

      try {
        // Nou pase ID ki soti nan Flutter a
        window.ironSource.setUserId(flutterUserId);
        
        window.ironSource.showRewardedVideo({
          placementName: 'Soutien_Video',
          onComplete: () => {
            console.log("Piblisite fini!");
            resolve(true);
          },
          onFailed: (err) => {
            console.error("Piblisite echwe:", err);
            resolve(false);
          }
        });
      } catch (e) {
        console.error("Erè teknik:", e);
        resolve(false);
      }
    });
  }
</script></head> 
 <body>
  <script src="flutter_bootstrap.js" async></script>

  <script src="https://web-bridge.is.com/sdk/v1/bundle.js" onerror="console.error('SDK bloke oswa pa jwenn')"></script>

  <script>
    // Fonksyon inisyalizasyon
    window.addEventListener('load', function() {
      // Nou tcheke si bridge la la anvan nou fè anyen
      if (window.isWebBridge) {
        isWebBridge.init({
          appKey: '4350361',
          onSuccess: () => console.log('LevelPlay pare!'),
          onFail: (err) => console.log('Init fail: ' + err.message)
        });
      }
    });

    // Fonksyon Flutter rele a
    async function afichePubUnity(userId) {
      if (!window.isWebBridge) {
        console.error("SDK pa chaje");
        return false;
      }
      return new Promise((resolve) => {
        isWebBridge.showRewardedVideo({
          placementName: 'Soutien_Video',
          onComplete: () => resolve(true),
          onFailed: (err) => resolve(false)
        });
      });
    }
  </script>
</body>
</html>